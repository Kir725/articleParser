# articleParser
### [OddMorning.github.io/articleParser](https://OddMorning.github.io/articleParser)

Эта штука помогает подготавливать текст статей для перевода через Google Docs.
Необходимо вручную открыть исходный код интересующей страницы и скопировать её HTML код сюда, желательно код одной лишь статьи (например, он может находиться внутри тега `<article>`). Всю остальную грязную работу сделает страничка по ссылке выше.

# Что оно умеет (1.0)

_[История изменений](history.md)_

## Для Google Docs
### HTML => Markdown
Конвертирует HTML код в Markdown при помощи [to-markdown](https://github.com/domchristie/to-markdown) и небольшой ~~магии~~ постобработки.

Постобработка заключается в корректной замене `<pre><code>…</code></pre>` на ` ```…``` ` (с переносами на новую строку), скрытия некоторых остатков тегов (вроде встречающихся местами `<div>`) и некоторых других манипуляций с тегами.

### Конвертировать в таблицу и скачать
Генерирует таблицу из двух столбцов и помещает найденные абзацы (что между `\n\n`) в первую колонку. Вторая колонка остаётся пустой за исключением случаев, когда абзац является заголовком (`#`), кодом (` ``` `), цитатой (`>`), списком (`*`), блоком с markdown ссылками или чем-то ещё. Чтобы потом не набирать их вручную.

Происходит всё это «за кадром» (потому что генерируемый код выглядит слишком громоздко и смотреть на его просто нет смысла), а результат скачивается в виде `.html` файла, который нужно загрузить в Google Docs через:

`Файл > Открыть > Загрузка > Выбрать файл на компьютере`

Для удобства чтения все ссылки (включая их сноски вида `[текст][#1]`) становятся кликабельными, блоки кода пишутся моноширинным мелким шрифтом, а картинки (если таковые имеются) отображаются прямо в документе.

## Из Google Docs
**Ремарка:** Google Docs принудительно конвертирует звёздочки в HTML списки, и, к счастью, их структура не замудрена, поэтому импорт конвертирует успешно конвертирует их обратно в звёздочки. Чего не скажешь о прочих радостях форматирования вроде жирного текста, курсива и прочих. Google конвертирует их в множество бессмысленных тегов вроде `<p class='c5'><span class='c2'></span></p>`. Распарить их, конечно, можно, но это несколько муторно и лично я не вижу в этом смысла, поэтому лучше оформлять текст в стиле Markdown.

Если вкратце: документ из Google Docs обрабатывается исключительно в текстовом виде (за исключением списков), поэтому вместо **жирного** и _наклонного_ текста следует обрамлять их в соответствующие теги Markdown.

Небольшая справка по форматированию:

Markdown | Пояснение
:-------- | :-------
`*текст* или _текст_`  | Наклонный
`**текст** или __текст__` | Жирный
`#` | Заголовок (одна решётка `<h1>`, две `<h2>`…)
`[Описание](url)` | Ссылка
`[Описание][сноска]` и `[сноска]: url` | Ссылка с ссылкой ( :D )
`![alt](url)` | Изображение
\`код\` | Код
` ```код``` ` | Блок кода (` ``` ` обязательно должны находиться на отдельных строках)
`(( iframe: ссылка ))` | <iframe> (не часть языка markdown)
`(( video: ссылка ))` | <video> (не часть языка markdown)
  
Более подробно можно найти в гугле по запросу «Синтаксис Markdown», например вот [одна из таких статей](http://www.diy.ru/info/markdown/).

### Импорт .zip файла
Экспорт из Google Docs:

`Файл > Скачать как > Загрузка > Веб страница (HTML, ZIP-архив)`

После выбора `Импорт .zip файла` следует выбрать сохранённый `.zip` архив. Скрипт распакует архив (слава [JSZip](https://stuk.github.io/jszip/)!), распарсит HTML код и отобразит на странице содержимое второй колонки.

### Markdown => HTML
Конвертирует HTML код в Markdown при помощи [showdown](https://github.com/showdownjs/showdown) (на этот раз почти что без ~~магии~~ постобработки).

## Найти и заменить
По умолчанию поиск и замена происходят по упрощённому синтаксису. Никаких спец символов, только лишь `**`, которое соответствует регулярному выражению `([\s\S]*?)`, т.е. «найти всё-всё и захватить в группу». Почему не `(.*?)`? Точка не находит переносы на новую строку

Например, можно в первое поле ввода написать `<figcaption>**</figcaption>`, во второе `Подпись: $1`, и оно заменит все `figcaption` на указанный текст, подставив содержимое тега вместо первого совпадения (`$1`).

### (галочка в заголовке)
Включает «взрослые» регулярки, убирая этот детский `**` и экранизацию всех спецсимволов. Аналогом примера выше будет `<figcaption>([\s\S]*?)<\/figcaption>`. Флаги `gi` стоят по умолчанию, их изменять нельзя (да и нужно ли?). 

### Предпросмотр
Показывает в обычном `alert`'е нашло ли что, и на что оно его могло бы заменить. Показывает только первое совпадение.

### Заменить всё
Молча заменяет (или не заменяет, тут как карта ляжет) все совпадения. Молча, потому что я устал и мне лень обрабатывать ошибки. Может, потом сделаю покрасивее, заодно убрав этот скучный `alert` :D

## Разное 

### Открыть текстовый файл
Предлагает открыть файл с компьютера, перенося содержимое файла в поле ввода текста.

### Скачать в .txt
Просто скачивает содержимое поля ввода текста как `.txt` файл. На всякий случай, вдруг пригодится?

### Открыть описание на GitHub
Открывает страницу с этим текстом (`README.md`) в новой вкладке.
